<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <!-- Update these variables for customer: -->
  <script>
    var whatsappNo = '919879876947'; // Update WhatsApp Number
    var previewImage = '/thumbnail.png'; // Added leading slash for better path detection
  </script>
  <!-- WhatsApp preview when link is shared -->
  <meta property="og:image" content="/thumbnail.png" /> <!-- Changed to leading slash path -->
  <meta property="og:image:width" content="720" />
  <meta property="og:image:height" content="405" />
  <meta property="og:title" content="Taxi Booking — Amar Cab Services" />
  <meta property="og:description" content="Book your taxi instantly with Amar Cab Services" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Taxi Booking — Amar Cab Services</title>
  <style>
    :root {
      --accent:#0b7;
      --text:#111;
      --card-max-width:720px;
      --safe-top: env(safe-area-inset-top, 16px);
    }
    html,body {
      height:100%;
      margin:0;
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      color:var(--text);
      background: linear-gradient(180deg,#f7f9fb,#ffffff);
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      box-sizing:border-box;
    }
    *, *::before, *::after { box-sizing:inherit; }
    body {
      padding-top: calc(var(--safe-top) + 8px);
      padding-left: 12px;
      padding-right: 12px;
      padding-bottom: calc(env(safe-area-inset-bottom, 12px));
      display: flex;
      align-items: flex-start;
      justify-content: center;
      gap: 12px;
      min-height: 100vh;
    }
    .container {
      width: 100%;
      max-width: var(--card-max-width);
      display: flex;
      flex-direction: column;
      align-items: stretch;
      margin: 0 auto;
    }
    .hero-wrap {
      width: 100%;
      margin: 0;
      padding-top: 0;
      background: #eaeaea;
      overflow: hidden;
      border-radius: 12px 12px 0 0;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .hero-wrap img {
      display: block;
      width: 100%;
      max-width: 100%;
      height: auto;
      aspect-ratio: 16 / 9;
      object-fit: contain;
      object-position: center;
      border-radius: 12px 12px 0 0;
      background: #eaeaea;
      -webkit-user-select: none;
      user-select: none;
    }
    @media(min-width: 720px) {
      .container {
        margin-top: 32px;
      }
    }
    .card {
      width: 100%;
      background: #fff;
      border-radius: 0 0 12px 12px;
      box-shadow: 0 6px 24px rgba(20,30,60,0.08);
      padding:18px;
      box-sizing: border-box;
      margin-top: 0;
    }
    h1 { font-size:18px; margin:0 0 8px }
    .subtitle { font-size:14px; color:#555; margin-bottom:12px }
    label {
      display:block;
      margin:10px 0 6px;
      font-size:15px;
      font-weight:700;
      color:#222;
    }
    label.required::after {
      content:" *";
      color:#d33;
      margin-left:2px;
      font-weight:700;
    }
    input,select,textarea {
      width:100%;
      box-sizing: border-box;
      padding:12px 14px;
      border:1px solid #e6eef6;
      border-radius:10px;
      font-size:15px;
      background:#fff;
    }
    select { padding:10px 12px }
    .row { display:flex; gap:10px }
    .row > * { flex:1 }
    .btn { display:block; width:100%; padding:12px; border-radius:10px; border:0; background:var(--accent); color:#022; font-weight:700; font-size:16px; margin-top:14px }
    .note { font-size:13px; color:#666; margin-top:8px }
    .footer { font-size:12px; color:#888; text-align:center; margin-top:14px }
    .wa-fallback {
      text-align: center;
      padding: 18px;
      background: #fff3f1;
      border-radius: 10px;
      border: 1px solid #ffd1c1;
      color: #c00;
      font-size: 15px;
      margin-top: 20px;
      display: none; /* Keep hidden by default */
    }
    .wa-call {
      display: inline-block;
      margin-top: 12px;
      padding: 10px 24px;
      font-size: 16px;
      background: var(--accent);
      color: #022;
      border: none;
      border-radius: 8px;
      text-decoration: none;
      font-weight: 700;
    }
    @media (max-width:420px) {
      .card { padding:14px }
      h1 { font-size:16px }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="hero-wrap" aria-hidden="true">
      <img src="/thumbnail.png" alt="Amar Cab Services — banner">  <!-- Added leading slash -->
    </div>
    <main class="card" role="main" aria-labelledby="formTitle">
      <h1 id="formTitle">Taxi Booking Request</h1>
      <p class="subtitle">Fill the form and tap <em>Send to WhatsApp</em> to open WhatsApp with your booking details.</p>
      <form id="taxiForm" novalidate>
        <label for="custName" class="required">Name</label>
        <input id="custName" name="custName" type="text" placeholder="Your full name" required>
        <label for="custMobile" class="required">Mobile no</label>
        <input id="custMobile" name="custMobile" type="tel" placeholder="e.g. 9422xxxxx" pattern="[0-9+()\s-]{6,}" required>
        <label for="date" class="required">Pick date</label>
        <input id="date" name="date" type="date" required>
        <label for="time" class="required">Pick up time</label>
        <div class="row">
          <select id="hour" required>
            <option value="">Hour</option>
            <option>01</option><option>02</option><option>03</option><option>04</option><option>05</option>
            <option>06</option><option>07</option><option>08</option><option>09</option><option>10</option>
            <option>11</option><option>12</option>
          </select>
          <select id="minute" required>
            <option value="">Min</option>
            <option>00</option><option>15</option><option>30</option><option>45</option>
          </select>
          <select id="ampm" required>
            <option value="">AM/PM</option>
            <option>AM</option>
            <option>PM</option>
          </select>
        </div>
        <label for="pickup" class="required">Pick up location</label>
        <input id="pickup" name="pickup" type="text" placeholder="Enter pick up address or landmark" required>
        <label for="drop" class="required">Drop location</label>
        <input id="drop" name="drop" type="text" placeholder="Enter drop address or landmark" required>
        <button type="submit" class="btn">Send to WhatsApp</button>
        <p class="note">This opens WhatsApp (Personal or Business) on mobile. On desktop it will open WhatsApp Web if available.(ver:1.00)</p>
      </form>
      <div class="footer">
        Developed by:
        <a href="https://wa.me/919879876947?text=I%20need%20your%20help%20for%20my%20Business" target="_blank" rel="noopener noreferrer">GOA DIGITAL SERVICES</a>
      </div>
      <div class="wa-fallback" id="waFallback">
        WhatsApp is not installed or not opened in browser.<br>
        You need to install WhatsApp or open WhatsApp Web in your browser.<br>
        <a class="wa-call" id="callBtn" target="_blank" rel="noopener noreferrer">Call Now</a>
      </div>
    </main>
  </div>
  <script>
    // Variables for customer
    var phoneNumber = (typeof whatsappNo !== "undefined") ? whatsappNo : '919879876947';
    var previewImgUrl = (typeof previewImage !== "undefined") ? previewImage : '/thumbnail.png';

    const form = document.getElementById('taxiForm');
    const dateInput = document.getElementById('date');
    const hourSel = document.getElementById('hour');
    const minSel = document.getElementById('minute');
    const ampmSel = document.getElementById('ampm');
    const custName = document.getElementById('custName');
    const custMobile = document.getElementById('custMobile');
    const waFallback = document.getElementById('waFallback');
    const callBtn = document.getElementById('callBtn');

    // Set call button href at runtime
    callBtn.href = 'tel:+' + phoneNumber;

    const monthsShort = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
    function formatDateToDDMMMYYYY(value){
      if(!value) return '';
      const parts = value.split('-');
      if(parts.length !== 3) return value;
      const y = parts[0], m = parseInt(parts[1],10) - 1, d = parts[2];
      const month = monthsShort[m] || '';
      const day = d.length === 1 ? '0'+d : d;
      return day + '-' + month + '-' + y;
    }
    function starLabel(text){ return '*' + text + '*'; }

    form.addEventListener('submit', function(e){
      e.preventDefault();

      if(!custName.value.trim() || !custMobile.value.trim() || !dateInput.value){
        alert('Please complete required fields: Name, Mobile and Pick date.');
        return;
      }

      let message = starLabel('Taxi Booking Request') + '\n\n';
      message += starLabel('Name') + ': ' + (custName.value || '') + '\n';
      message += starLabel('Mobile no') + ': ' + (custMobile.value || '') + '\n\n';
      const rawDate = dateInput.value || '';
      const date = formatDateToDDMMMYYYY(rawDate);
      message += starLabel('Pick date') + ': ' + date + '\n';
      const hour = hourSel.value;
      const min = minSel.value;
      const ampm = ampmSel.value;
      const time = (hour && min && ampm) ? hour + ':' + min + ' ' + ampm : '';
      message += starLabel('Pick up time') + ': ' + time + '\n\n';
      message += starLabel('Pick up location') + ': ' + (document.getElementById('pickup').value || '') + '\n';
      message += starLabel('Drop location') + ': ' + (document.getElementById('drop').value || '') + '\n\n';
      message += 'Please confirm.';

      // Encode for WhatsApp URL
      const encoded = encodeURIComponent(message);

      const waWeb = 'https://wa.me/' + phoneNumber + '?text=' + encoded;
      const waApp = 'whatsapp://send?phone=' + phoneNumber + '&text=' + encoded;

      // Try opening Whatsapp app on mobile
      let attempted = false;
      function fallback(){
        if(attempted) return;
        attempted = true;
        // Show fallback message & call button
        waFallback.style.display = 'block';
      }

      // Try native app, then fallback to web after short delay
      let isMobile = /Android|iPhone|iPad|iPod/i.test(navigator.userAgent);
      if(isMobile){
        window.location.href = waApp;
        setTimeout(function(){
          // After 1.2 sec, if still not redirected (likely WhatsApp not installed), open web
          window.location.href = waWeb;
          setTimeout(fallback, 1600);
        }, 1200);
      }else{
        // On desktop always go to WhatsApp Web
        window.open(waWeb, '_blank');
        setTimeout(fallback, 1200);
      }
    });

    // Default date = today
    try{
      const today = new Date();
      const yyyy = today.getFullYear();
      let mm = today.getMonth() + 1; if(mm < 10) mm = '0' + mm;
      let dd = today.getDate(); if(dd < 10) dd = '0' + dd;
      dateInput.value = yyyy + '-' + mm + '-' + dd;
    }catch(e){}
  </script>
</body>
</html>
